# **密码学课程复习笔记**

# 密码学课程复习笔记

这份笔记基于9份课程PDF文件整理，包含每章节的**知识概要**、**核心考点**及**重点批注**（基于PPT中的强调内容和思考题）。

---

## 1\. 分组密码与DES (\`03分组密码与DES.pdf\`)

知识概要

• **分组密码原理**：将明文划分为固定长度的组（如64位），每组在密钥控制下变换为等长密文。

• **Feistel结构**：

  • 大多数对称密码的基础（DES使用）。

  • **构造**：将数据分为左右两半，多轮迭代。

  • **核心特性**：加密和解密过程结构相同，只需逆序使用子密钥。

  • **设计要素**：分组大小（通常64或128位）、密钥长度、轮数（通常16轮）、子密钥生成算法、轮函数 $F$。

• **混淆与扩散 (Shannon)**：

  • **扩散 (Diffusion)**：明文统计特性散布到密文，一位明文变动影响多位密文。

  • **混淆 (Confusion)**：密文与密钥的关系尽可能复杂。

核心考点 & 批注

• **DES算法参数**：

  • 明文/密文分组长度：**64 bits**。

  • 密钥长度：**64 bits**（其中**56 bits**为有效密钥，8位用于校验）。

  • 迭代轮数：**16轮**。

• **关键组件**：

  • **S盒 (S-Box)**：DES中唯一的**非线性**部件，提供混淆，是安全性的核心。输入6位，输出4位。

  • **雪崩效应**：明文或密钥改变1位，密文约有一半位发生变化。

• **安全性**：56位密钥过短，易受暴力破解（穷举搜索）。

• **工作模式**：

  • **ECB (电子密码本)**：相同明文对应相同密文，不安全，仅适合短数据。

  • **CBC (密码分组链接)**：引入初始向量IV，当前明文与前一密文异或，隐蔽模式信息，常用。

  • **CTR (计数器模式)**：可并行计算，效率高。

---

## 2\. 现代对称加密及传输保密性 (\`04现代对称加密及其传输保密性.pdf\`)

知识概要

• **多重DES**：

  • **双重DES**：易受**中间相遇攻击 (Meet-in-the-middle attack)**，安全性并未真正达到 $2^{112}$。

  • **3DES (Triple DES)**：$C \= E\_{K3}(D\_{K2}(E\_{K1}(P)))$。通常使用双密钥（K1=K3）或三密钥。有效密钥长度112位或168位。

• **其他算法**：

  • **Blowfish**：快速、紧凑、密钥长度可变。

  • **RC5**：参数可变（字长、轮数、密钥），依赖数据循环移位。

• **流密码 (Stream Ciphers)**：

  • 原理：生成伪随机密钥流，与明文按位异或。

  • 要求：密钥流不可预测、周期长、统计随机。

  • **RC4**：典型的流密码。

• **加密位置**：

  • **链路加密**：每一跳解密再加密，中间节点为明文（易受攻击）。

  • **端到端加密**：源到目的全程加密，中间节点不可见内容，但流量模式可见。

核心考点 & 批注

• **中间相遇攻击**：解释了为什么双重加密不安全。

• **密钥分配**：

  • **KDC (密钥分配中心)**：集中式，通过票据（Ticket）分发会话密钥。

  • **Diffie-Hellman**：用于不需要KDC的双方密钥协商。

• **随机数生成**：

  • 真随机数 vs 伪随机数 (PRNG)。

  • **线性同余法**：常用但不可用于加密（可预测）。

---

## 3\. 公钥密码学与RSA (\`05公钥密码学与RSA.pdf\`)

知识概要

• **公钥密码体制**：解决密钥分发和数字签名问题。

• **数学基础**：

  • **陷门单向函数**：计算正向容易，求逆困难（除非有陷门信息）。

  • **欧拉定理**：$a^{\\phi(n)} \\equiv 1 \\pmod n$。

  • **费马小定理**：$a^{p-1} \\equiv 1 \\pmod p$。

• **RSA算法**：

  • 基于大整数**因子分解**的困难性。

  • **密钥生成**：

    1. 选两个大素数 $p, q$。

    2. 计算 $n \= p \\times q$，$\\phi(n) \= (p-1)(q-1)$。

    3. 选公钥 $e$，满足 $\\gcd(e, \\phi(n)) \= 1$。

    4. 计算私钥 $d$，满足 $e \\times d \\equiv 1 \\pmod{\\phi(n)}$。

  • **加密**：$C \= M^e \\pmod n$。

  • **解密**：$M \= C^d \\pmod n$。

核心考点 & 批注

• **计算效率**：公钥加密比对称加密慢很多（约100-1000倍），通常用于加密小数据（如会话密钥）或签名。

• **安全性依赖**：$n$ 的长度（至少512位，推荐1024/2048位），$p, q$ 保密。

• **主要应用**：加密/解密、数字签名、密钥交换。

---

## 4\. 密钥管理 (\`06密钥管理.pdf\`)

知识概要

• **公钥分配方法**：

  1. **公开发布**：易被伪造。

  2. **公用目录**：需维护，目录易受篡改。

  3. **公钥授权中心**：瓶颈问题。

  4. **公钥证书 (Certificate)**：由CA签名，最常用。

• **Diffie-Hellman (DH) 密钥交换**：

  • 目的：在不安全通道上安全协商共享密钥。

  • 原理：基于**离散对数**难题。

  • 步骤：

    1. 双方共享素数 $q$ 和本原根 $a$。

    2. A选私密 $X\_A$，发送 $Y\_A \= a^{X\_A} \\pmod q$。

    3. B选私密 $X\_B$，发送 $Y\_B \= a^{X\_B} \\pmod q$。

    4. 双方计算共享密钥 $K \= (Y\_B)^{X\_A} \= (Y\_A)^{X\_B} \= a^{X\_A X\_B} \\pmod q$。

核心考点 & 批注

• **DH的弱点**：易受**中间人攻击 (Man-in-the-Middle Attack)**，因为它不提供身份认证。

• **证书的作用**：绑定实体身份与公钥，由CA的私钥签名保证完整性。

---

## 5\. 消息认证与Hash算法 (\`07消息认证与Hash算法.pdf\`)

知识概要

• **安全需求**：保密性、完整性、认证、不可否认性。

• **认证函数**：

  • **MAC (消息认证码)**：使用密钥，提供认证和完整性。

  • **Hash函数**：将任意长度映射为固定长度（摘要），无密钥。

• **Hash函数特性**：

  • 单向性（抗原像）。

  • 弱抗碰撞性（抗第二原像）。

  • 强抗碰撞性（难找到任意一对 $x, y$ 使得 $H(x)=H(y)$）。

• **MD5**：输出128位，已被证明不安全（存在碰撞攻击）。

• **SHA-1**：输出160位。

核心考点 & 批注

• **生日悖论**：对于 $m$ 位的Hash，强抗碰撞性只需 $2^{m/2}$ 次尝试即可找到碰撞。

• **Hash通用结构**：Merkle-Damgard 结构，分块处理，填充padding。

• **攻击与对策表**：

  • 伪装 \-\> 消息认证。

  • 内容修改 \-\> 消息认证/数字签名。

  • 发送方否认 \-\> 数字签名。

---

## 6\. 数字签名和认证协议 (\`08数字签名和认证协议.pdf\`)

知识概要

• **数字签名**：

  • 特性：验证作者、日期、内容完整性，第三方可验证（解决抵赖）。

  • 实现：发送方用**私钥**加密消息摘要（Hash），接收方用公钥验证。

• **重放攻击 (Replay Attack)**：攻击者重发旧消息。

  • **对策**：时间戳 (Timestamps)、序列号 (Sequence Numbers)、**临时交互号 (Nonce)**（随机数）。

• **认证应用**：

  • **Kerberos**：基于对称密钥的集中式认证服务（TGT, Ticket）。解决分布式网络中的身份认证。

  • **X.509**：基于公钥证书的目录认证服务。定义了证书格式（版本、序列号、签名算法、颁发者、有效期、主体、公钥、CA签名）。

核心考点 & 批注

• **Kerberos流程**：AS (认证服务器) \-\> TGT \-\> TGS (票据授权服务器) \-\> Service Ticket \-\> 应用服务器。

• **X.509证书链**：通过信任链（层次结构）验证证书。

• **CRL**：证书撤销列表。

---

## 7\. 电子邮件安全 (\`09电子邮件安全.pdf\`)

知识概要

• **PGP (Pretty Good Privacy)**：

  • **混合加密**：用一次性会话密钥（对称，如IDEA/3DES）加密邮件内容，用接收方公钥（RSA）加密会话密钥。

  • **数字签名**：用发送方私钥加密邮件Hash（SHA-1）。

  • **压缩**：ZIP压缩（签名后，加密前），增加安全性并节省空间。

  • **Radix-64**：将二进制密文转换为ASCII文本，以便邮件传输。

• **S/MIME**：基于MIME的工业标准，集成于Outlook等，依赖X.509证书体系。

核心考点 & 批注

• **PGP的信任模型**：Web of Trust（信任网），不同于X.509的层级CA模型。

• **加密与签名的顺序**：通常先签名后加密（与物理信件习惯一致，且验证时不需要先解密）。

---

## 8\. IP安全性 (\`10IP安全性.pdf\`)

知识概要

• **IPSec**：IP层的安全标准，为IPv4和IPv6提供安全。

• **两大协议**：

  • **AH (Authentication Header)**：提供源认证和数据完整性，**不提供加密**。

  • **ESP (Encapsulating Security Payload)**：提供加密（保密性），也可选提供认证。

• **两种模式**：

  • **传输模式 (Transport Mode)**：只保护载荷（上层数据），IP头不加密。用于端到端（主机对主机）。

  • **隧道模式 (Tunnel Mode)**：加密整个IP包，封装新IP头。用于VPN（网关对网关）。

• **密钥管理**：IKE (Internet Key Exchange)。

核心考点 & 批注

• **SA (安全关联)**：单向逻辑连接，由三元组标识（**SPI, 目的IP, 协议标识**）。

• **应用场景**：VPN构建（隧道模式）。

---

## 9\. Web安全 (\`11Web安全.pdf\`)

知识概要

• **SSL/TLS (Secure Sockets Layer)**：

  • 位于TCP层之上，应用层之下。

  • **握手协议 (Handshake)**：协商加密算法、认证服务器、交换密钥（Pre-master secret）。

  • **记录协议 (Record)**：分片、压缩、MAC、加密。

• **SET (安全电子交易)**：

  • 专为信用卡交易设计。

  • **双重签名 (Dual Signature)**：链接**定购信息(OI)和支付信息(PI)**。

  • **目的**：商家只能看到定购信息（不知道卡号），银行只能看到支付信息（不知道买了什么），但双方都能验证交易的关联性。

核心考点 & 批注

• **SSL握手**：客户端发送ClientHello \-\> 服务器ServerHello+证书 \-\> 客户端验证证书 \-\> 生成会话密钥。

• **SET的双重签名机制**：是保障隐私（商家不可见卡号）的关键技术。

• **对比**：SSL保护通道安全，SET保护交易过程的特定逻辑。