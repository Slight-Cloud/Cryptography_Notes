# 记录可能考点

## 名词解释标准解答（背诵/考试用）

### 定义 2.2.2 (扩散 (Diffusion))

**解答**：

明文的统计结构被扩散消失到密文的**长程统计特性**, 使得明文和密文之间的**统计关系尽量复杂**

*如P盒通过置换(线性变换)实现扩散。*

### 定义 2.2.3 (混乱 (Confusion))

**解答**：
使得**密文的统计特性**与**密钥的取值**之间的关系尽量复杂

*如S盒通过非线性代换实现混乱。*

### 定义 2.2.4 (完善保密性 / 理想密码系统)

**解答**：
指在理想密码系统中，**密文不提供关于明文的任何信息**（如一次一密）。在此系统中，攻击者拥有无限计算资源和时间也无法破解。安全不依赖于任何计算假设。。

### 定义 2.2.5 (雪崩效应 (Avalanche Effect))

**解答**：
指密码算法的一种理想特性，即**明文或密钥**发生**微小的改变**（例如仅改变 1 比特），都应导致**输出的密文发生显著变化**（理想情况下，密文有一半的比特位发生翻转）。这体现了算法具有良好的随机性和对输入的敏感性。

---

## 计算题：

### S-DES 算法

***(1) 生成子密钥 K₁、K₂***

***(2) 加密明文 `01110010`***

#### 题目附录：算法组件

##### 置换表

| 组件             | 映射规则                 | 说明                 |
| ---------------- | ------------------------ | -------------------- |
| **P10**    | `3 5 2 7 4 10 1 9 8 6` | 10位密钥初始置换     |
| **P8**     | `6 3 7 4 8 5 10 9`     | 8位子密钥生成置换    |
| **IP**     | `2 6 3 1 4 8 5 7`      | 初始置换             |
| **IP⁻¹** | `4 1 3 5 7 2 8 6`      | 逆初始置换           |
| **EP**     | `4 1 2 3 2 3 4 1`      | 扩展置换（4位→8位） |
| **P4**     | `2 4 3 1`              | 4位置换              |

##### S盒

**S0 盒**：

```
    列  0   1   2   3
行 0 |  1   0   3   2
   1 |  3   2   1   0
   2 |  0   2   1   3
   3 |  3   1   3   2
```

**S1 盒**：

```
    列  0   1   2   3
行 0 |  0   1   2   3
   1 |  2   0   1   3
   2 |  3   0   1   0
   3 |  2   1   0   3
```

#### (1)子密钥生成

##### Step 1: P10 置换

**输入**：`1010000010`

按 P10 规则 `3 5 2 7 4 10 1 9 8 6` 重排：

```
位置：  1  2  3  4  5  6  7  8  9  10
原值：  1  0  1  0  0  0  0  0  1  0
       ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓
P10取： 3  5  2  7  4  10 1  9  8  6
结果：  1  0  0  0  0  0  1  1  0  0
```

**P10 输出**：`1000001100`

##### Step 2: 拆分为左右两部分

- **L₀** = `10000`（前5位）
- **R₀** = `01100`（后5位）

##### Step 3: 生成 K₁（LS-1 → P8）

###### 3.1 循环左移1位（LS-1）

- **L₁** = `00001`（`10000` 左移1位）
- **R₁** = `11000`（`01100` 左移1位）

**合并**：`0000111000`

###### 3.2 P8 置换

按 P8 规则 `6 3 7 4 8 5 10 9` 取位：

```
位置：  1  2  3  4  5  6  7  8  9  10
原值：  0  0  0  0  1  1  1  0  0  0
       ↓     ↓  ↓  ↓  ↓  ↓     ↓  ↓
P8取：  6     3  7  4  8  5     10 9
结果：  1     0  1  0  0  1     0  0
```

**K₁** = `10100100`

##### Step 4: 生成 K₂（LS-2 → P8）

###### 4.1 在 L₁、R₁ 基础上继续循环左移2位（LS-2）

- **L₂** = `00100`（`00001` 左移2位）
- **R₂** = `00011`（`11000` 左移2位）

**合并**：`0010000011`

###### 4.2 P8 置换

按 P8 规则 `6 3 7 4 8 5 10 9` 取位：

```
位置：  1  2  3  4  5  6  7  8  9  10
原值：  0  0  1  0  0  0  0  0  1  1
       ↓     ↓  ↓  ↓  ↓  ↓     ↓  ↓
P8取：  6     3  7  4  8  5     10 9
结果：  0     1  0  0  0  0     1  1
```

**K₂** = `01000011`

#### (2)加密明文

##### Step 1: 初始置换（IP）

**输入明文**：`01110010`

按 IP 规则 `2 6 3 1 4 8 5 7` 重排：

```
位置：  1  2  3  4  5  6  7  8
原值：  0  1  1  1  0  0  1  0
       ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓
IP取：  2  6  3  1  4  8  5  7
结果：  1  0  1  0  1  0  0  1
```

**IP 输出**：`10101001`

**拆分**：

- **L₀** = `1010`
- **R₀** = `1001`

##### Step 2: 第一轮加密 fₖ(R₀, K₁)

###### 2.1 扩展置换（EP）

对 R₀ = `1001` 应用 EP 规则 `4 1 2 3 2 3 4 1`：

```
R₀位置：     1  2  3  4
R₀值：       1  0  0  1
            ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓
EP取位：     4  1  2  3  2  3  4  1
EP(R₀)：     1  1  0  0  0  0  1  1
```

**EP(R₀)** = `11000011`

###### 2.2 与 K₁ 异或

```
EP(R₀)：  1  1  0  0  0  0  1  1
K₁：      1  0  1  0  0  1  0  0
        ⊕ ⊕ ⊕ ⊕ ⊕ ⊕ ⊕ ⊕
结果：    0  1  1  0  0  1  1  1
```

**异或结果**：`01100111`

###### 2.3 S盒代换

**左半部分** `0110` → S0：

- 行 = `00` (首尾位) = 0
- 列 = `11` (中间位) = 3
- S0[0][3] = 2 = `10`

**右半部分** `0111` → S1：

- 行 = `01` (首尾位) = 1
- 列 = `11` (中间位) = 3
- S1[1][3] = 3 = `11`

**S盒输出**：`1011`

###### 2.4 P4 置换

对 `1011` 应用 P4 规则 `2 4 3 1`：

```
位置：  1  2  3  4
原值：  1  0  1  1
       ↓  ↓  ↓  ↓
P4取：  2  4  3  1
结果：  0  1  1  1
```

**P4 输出**：`0111`

**因此 f(R₀, K₁) = `0111`**

###### 2.5 更新左半部分

```
L₁ = L₀ ⊕ f(R₀, K₁)
   = 1010 ⊕ 0111
   = 1101
```

###### 2.6 交换（SW）

**第一轮结束后**：

- **左半部分** = $R_0$ = `1001`
- **右半部分** = $L_0 \oplus f(R_0, K_1)$ = `1101`

##### Step 3: 第二轮加密 fₖ(R₁, K₂)

**当前状态**：L₁ = `1001`，R₁ = `1101`

###### 3.1 扩展置换（EP）

对 R₁ = `1101` 应用 EP 规则：

```
R₁位置：     1  2  3  4
R₁值：       1  1  0  1
            ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓
EP取位：     4  1  2  3  2  3  4  1
EP(R₁)：     1  1  1  0  1  0  1  1
```

**EP(R₁)** = `11101011`

###### 3.2 与 K₂ 异或

```
EP(R₁)：  1  1  1  0  1  0  1  1
K₂：      0  1  0  0  0  0  1  1
        ⊕ ⊕ ⊕ ⊕ ⊕ ⊕ ⊕ ⊕
结果：    1  0  1  0  1  0  0  0
```

**异或结果**：`10101000`

###### 3.3 S盒代换

**左半部分** `1010` → S0：

- 行 = `10` = 2
- 列 = `01` = 1
- S0[2][1] = 2 = `10`

**右半部分** `1000` → S1：

- 行 = `10` = 2
- 列 = `00` = 0
- S1[2][0] = 3 = `11`

**S盒输出**：`1011`

###### 3.4 P4 置换

对 `1011` 应用 P4 规则：

```
位置：  1  2  3  4
原值：  1  0  1  1
       ↓  ↓  ↓  ↓
P4取：  2  4  3  1
结果：  0  1  1  1
```

**P4 输出**：`0111`

**因此 f(R₁, K₂) = `0111`**

###### 3.5 更新左半部分

```
L₂ = L₁ ⊕ f(R₁, K₂)
   = 1001 ⊕ 0111
   = 1110
```

###### 3.6 合并（无交换）

**第二轮结束**，直接合并 L₂ 和 R₁：

- **合并结果** = L₂ || R₁ = `11101101`

##### Step 4: 逆初始置换（IP⁻¹）

**输入**：`11101101`

按 IP⁻¹ 规则 `4 1 3 5 7 2 8 6` 重排：

```
位置：  1  2  3  4  5  6  7  8
原值：  1  1  1  0  1  1  0  1
       ↓  ↓  ↓  ↓  ↓  ↓  ↓  ↓
IP⁻¹取：4  1  3  5  7  2  8  6
结果：  0  1  1  1  0  1  1  1
```

**最终密文 C** = `01110111`

#### 答案总结

- **K₁** = `10100100`
- **K₂** = `01000011`
- **密文 C** = `01110111`

---

### 1.RSA 算法手算练习

***(1)计算私钥 d***

***(2)加密明文 m = 5***

#### 1. 第一题解答：

##### 步骤0：参数准备

* $p = 7$
* $q = 17$
* $n = p \times q = 7 \times 17 = 119$
* $\phi(n) = (p-1)(q-1) = 6 \times 16 = 96$
* $e = 11$

我们需要求解 $d$，满足 $11d \equiv 1 \pmod{96}$。

##### 步骤1：辗转相除法 (Euclidean Algorithm)

计算 $\gcd(96, 11)$：

1. $96 = 8 \times 11 + 8$
2. $11 = 1 \times 8 + 3$
3. $8 = 2 \times 3 + 2$
4. $3 = 1 \times 2 + 1$  <-- 得到余数 1，停止

##### 步骤2：逆向回代 (Extended Euclidean)

我们将余数 1 表示为 11 和 96 的线性组合：

1. 从第4式移项：
   $$
   1 = 3 - 1 \times 2
   $$
2. 代入第3式 ($2 = 8 - 2 \times 3$)：
   $$
   1 = 3 - 1 \times (8 - 2 \times 3) = 3 - 8 + 2 \times 3 = 3 \times 3 - 8
   $$
3. 代入第2式 ($3 = 11 - 1 \times 8$)：
   $$
   1 = 3 \times (11 - 8) - 8 = 3 \times 11 - 3 \times 8 - 8 = 3 \times 11 - 4 \times 8
   $$
4. 代入第1式 ($8 = 96 - 8 \times 11$)：
   $$
   1 = 3 \times 11 - 4 \times (96 - 8 \times 11) =  35 \times 11 - 4 \times 96
   $$

##### 结论

$$
35 \times 11 \equiv 1 \pmod{96}
$$

私钥 $d = 35$。

#### 2. 第二题解答：

我们需要计算 $c \equiv 5^{11} \pmod{119}$。

##### 步骤1：指数二进制化

$e = 11$，其二进制为 **1011** ($8 + 2 + 1$)。
这意味着 $c \equiv 5^8 \times 5^2 \times 5^1 \pmod{119}$。

##### 步骤2：模重复平方法 (Square and Mod)

我们需要依次计算 $m^1, m^2, m^4, m^8 \pmod{119}$。

| 指数幂次 | 计算过程 (上一步结果的平方) | 取模结果 (mod 119)                                  | 备注   |
| -------- | --------------------------- | --------------------------------------------------- | ------ |
| $5^1$  | -                           | **5**                                         | (需要) |
| $5^2$  | $25$                      | **25**                                        | (需要) |
| $5^4$  | $25^2 = 625$              | $625 = 5 \times 119 + 30 \Rightarrow \mathbf{30}$ |        |
| $5^8$  | $30^2 = 900$              | $900 = 7 \times 119 + 67 \Rightarrow \mathbf{67}$ | (需要) |

##### 步骤三：组合相乘

根据二进制 $1011$，选取 $5^8, 5^2, 5^1$：

$$
c\equiv 67 \times 25 \times 5 \pmod{119}$$1. 先算 $25 \times 5 = 125$
   $$125 \pmod{119} = 6
$$

1. 再算 $67 \times 6$:

   $$
   67 \times 6 = 402
   $$
2. 最后取模：

   $$
   402 \div 119 = 3 \dots 45
   $$

   *(验证： $3 \times 119 = 357$ ,  $402 - 357 = 45$)*

##### 结论

加密后的密文 $c = 45$。

---

## 重要辨析：

### 加密模式&计网 5 层体系的加密方式总结

这份优化后的笔记严格遵循了之前的学术讨论结论。我对表格进行了重构，增加了**“执行实体” **一列，因为** “谁负责加密”直接决定了“信任边界在哪里”**。同时，完善了“信任边界”的定义，使其不再抽象。

#### 概述：

* **端到端加密 (E2E)** ：
  * **定义** ：数据在源端系统（进程或主机）加密，仅在目的端系统解密。
  * **特征** ：中间节点（路由器、交换机、ISP）只能处理头部路由信息，无法窥探载荷（Payload）。
  * **范围** ：应用层、传输层。
* **链路加密 (Link Encryption)** ：
  * **定义** ：数据在物理链路的每一跳（Hop）或虚拟链路的两端（Gateway）独立加密/解密。
  * **特征** ：中间节点必须拥有密钥，执行 `解密 -> 路由 -> 再加密` 的过程。
  * **范围** ：数据链路层、物理层。

#### 加密方式分类表

| **层次**                         | **典型协议**                            | **加密策略 (拓扑)**           | **执行实体 (谁负责加密)**    | **对上层数据的处理**                 | **封装后的逻辑结构**              | **信任边界 (严谨定义)**                                                                   |
| -------------------------------------- | --------------------------------------------- | ----------------------------------- | ---------------------------------- | ------------------------------------------ | --------------------------------------- | ----------------------------------------------------------------------------------------------- |
| **应用层**                       | PGP, S/MIME                                   | **端到端**(用户到用户)        | **应用程序**(用户态软件)     | **加密**消息体 + 签名                | `[应用头(可选)][{消息体}]`            | **仅信任应用自身**<br />边界在软件内存。若应用有漏洞或OS被攻破，密文在生成前即泄露。      |
| **传输层之上；<br />应用层之下** | TLS/SSL,SSH                                   | **端到端**(进程到进程)        | **加密库/进程**(如OpenSSL)   | **加密**应用层流/报文                | `[TCP头][{应用层报文}]`               | **信任主机进程 & OS**<br />边界在Socket接口。一旦跨越此边界（如被注入），属系统安全问题。 |
| **网络层**                       | **IPsec-AH**(传输模式)                  | **端到端**(主机到主机)        | **OS 内核**(网络协议栈)      | **认证**传输层段( **不加密** ) | `[原IP头][AH][<TCP/UDP段>]`           | **信任主机 OS 内核**<br />边界在网卡驱动之上。此时数据在OS内部是明文。                    |
| **网络层**                       | **IPsec-ESP**(传输模式)                 | **端到端**(主机到主机)        | **OS 内核**(网络协议栈)      | **加密**+**认证**传输层段      | `[原IP头][ESP头][{TCP/UDP段}][ESP尾]` | **信任主机 OS 内核**<br />同上。                                                          |
| **网络层**                       | **IPsec**(AH/ESP)( **隧道模式** ) | **虚拟链路**(网关到网关)      | **VPN 网关**(OS或专用硬件)   | **鉴别（且加密）**整个原IP包              | `[新IP头][ESP头][{原IP包}][ESP尾]`    | **信任 VPN 网关设备**<br />对内网主机透明。边界在网关内部，若网关被攻破，全网流量可见。   |
| **链路层**                       | WPA2/3, MACsec                                | **物理链路**(逐跳 Hop-by-Hop) | **网卡/基带芯片**(固件/硬件) | **加密**网络层包                     | `[MAC头][{IP数据包}][FCS]`            | **信任每一跳设备**<br />边界在物理设备。中间设备(如AP)必须解密才能交换/路由。             |
| **物理层**                       | 军用专线, 量子加密                            | **物理链路**(逐跳)            | **物理线路/中继器**          | **加密**比特流                       | `[{编码后的比特流}]`                  | **信任物理设施**<br />需拥有对物理线路的绝对控制权。                                      |

> **符号说明** ：`{ }` 表示加密（机密性）；`< >` 表示认证（完整性，但明文）；`[ ]` 表示协议单元边界。
>
> **TLS 的特殊地位** ：
>
> * 尽管带 "Transport" 字样，但它不属于 OS 内核的 TCP/IP 栈。
> * 它位于 **应用层 (HTTP)** 和 **传输层 (TCP)** 之间。应用程序通过库函数（如 `SSL_write`）调用它，它再将加密后的数据交给 TCP (`socket send`)。因此， **信任边界始于应用进程，终于内核 Socket** 。

#### 细节解析

##### 1. 数据状态与中间系统安全性

* **链路加密** ：
  * **状态** ：线路上传输是密文，但 **在中间节点（路由器/交换机）内部是明文** 。
  * **隐患** ：所有中间节点必须是可信的。如果攻击者控制了一台核心路由器，他可以看到所有流经的明文数据。
* **端到端加密** ：
  * **状态** ：线路上传输是密文， **在中间节点内部依然是密文** 。
  * **优势** ：中间网络设施被视为“不可信通道”。路由器只负责搬运“保险箱”，无法打开它。

##### 2. 用户角色与透明度

* **链路加密** ：
  * **对用户透明** ：作为用户，你连接 WiFi 时并不知道（也不需要操作）底层是否使用了 WPA2 加密，这是基础设施自动完成的。
  * **所有消息一视同仁** ：一旦链路加密开启，该链路上的所有流量（HTTP, FTP, DNS）都被强制加密。
* **端到端加密** ：
  * **用户/应用主导** ：通常由用户（选择使用 PGP）或应用程序（开发者决定使用 HTTPS）发起。
  * **粒度精细** ：用户可以选择只加密敏感数据（如密码），而不加密公开数据。

##### 3. 密钥管理与实现

* **链路加密** ：
  * **密钥数量爆炸** ：每两个相邻节点需要一对密钥。
  * **实现** ：通常由 **硬件** （网卡芯片）或底层固件实现，速度极快。
* **端到端加密** ：
  * **密钥独立** ：每对通信用户仅需协商他们自己的密钥，与网络路径无关。
  * **实现** ：通常由 **软件** （OS 内核或应用库）实现。

#### 对比表格

| **维度**          | **链路加密 (Link Encryption)**                                              | **端到端加密 (End-to-End Encryption, E2E)**                                       |
| ----------------------- | --------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| **1. 拓扑与边界** | **Hop-by-Hop (逐跳)**                                                       | **Source-to-Destination (源到宿)**                                                |
| *定义*                | 数据在每一段物理/逻辑链路上独立加密，在每一个中间节点（路由器/交换机）解密。      | 数据在源头加密，在穿越所有中间网络设施时保持密文，仅在最终目的地解密。                  |
| *保护范围*            | 点到点（Node-to-Node）。保护的是“管道”的每一截。                                | 端到端（User-to-User / Process-to-Process）。保护的是“数据本身”。                     |
| **2. 数据可见性** | **中间节点可见明文**                                                        | **中间节点不可见 (Blind)**                                                        |
| *节点行为*            | 中间节点必须拥有密钥，执行 `解密 -> 路由查看 -> 再加密`的过程。                 | 中间节点只看头部（Header）进行路由，无法解读负载（Payload）。                           |
| *弱点*                | **节点是攻击面** 。如果中间路由器被攻破或被管理员监听，数据即泄露。         | **端点是攻击面** 。只有发送者和接收者的设备（或软件）受控时才安全。               |
| **3. 实现与控制** | **低层、透明、基础设施化**                                                  | **高层、灵活、用户主导**                                                          |
| *透明性*              | **完全透明** 。上层协议（IP/TCP）和用户不知道链路被加密了（如 WiFi WPA2）。 | **不透明/半透明** 。通常由应用程序（如 Signal, PGP）或操作系统（IPsec）显式发起。 |
| *密钥管理*            | **简单但多** 。每对相邻节点需要共享密钥。全网需维护**$N$**对链路密钥。    | **复杂但独立** 。密钥协商仅在通信双方进行，与网络设施无关（如 Diffie-Hellman）。  |

---

## 快速记忆概念

### 1.Blowfish vs RC5 比较表

| **维度**     | **Blowfish (河豚)**    | **RC5 (变形金刚)**           |
| ------------------ | ---------------------------- | ---------------------------------- |
| **设计者**   | **B**ruce Schneier     | **R**on Rivest               |
| **杀手锏**   | **极致的速度**+ 小内存 | **高度灵活性**(参数化)       |
| **核心操作** | S-Box 查表 + 异或            | **数据相关的循环移位**       |
| **可变性**   | 仅密钥长度可变               | **字长、轮数、密钥**全由你定 |
| **应用场景** | 密码存储 (bcrypt)、嵌入式    | 学术研究、特定硬件架构适配         |
